import{r as c,j as e,B as g}from"./index-BadHY94B.js";function j(s){if(!s&&s!==0)return"-";const i=["B","KB","MB","GB"];let n=s,t=0;for(;n>=1024&&t<i.length-1;)n/=1024,t+=1;return`${n.toFixed(t===0?0:2)} ${i[t]}`}async function U(s){const i=URL.createObjectURL(s);try{return await new Promise((t,m)=>{const r=new Image;r.onload=()=>t(r),r.onerror=m,r.src=i})}finally{URL.revokeObjectURL(i)}}function R(s,i){const n=URL.createObjectURL(s),t=document.createElement("a");t.href=n,t.download=i,t.click(),URL.revokeObjectURL(n)}function M(){const[s,i]=c.useState(null),[n,t]=c.useState(.8),[m,r]=c.useState(1600),[h,v]=c.useState(!1),[u,x]=c.useState(!1),[o,p]=c.useState(null),y=c.useMemo(()=>s?s.size:null,[s]),b=c.useMemo(()=>o?o.size:null,[o]),N=async()=>{if(s){x(!0);try{const a=await U(s),l=document.createElement("canvas"),d=Math.min(1,m/a.width);l.width=Math.max(1,Math.round(a.width*d)),l.height=Math.max(1,Math.round(a.height*d)),l.getContext("2d").drawImage(a,0,0,l.width,l.height);const w=h&&s.type||"image/jpeg",f=await new Promise(C=>l.toBlob(C,w,n));p(f)}finally{x(!1)}}};return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{className:"h1",style:{fontSize:28},children:"Image Compressor"}),e.jsx("p",{className:"p",children:"Compress locally using Canvas. No uploads."})]}),e.jsx("span",{className:"badge",children:"Frontend only"})]}),e.jsxs("div",{className:"split",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"section",children:[e.jsx("label",{className:"label",children:"Upload image"}),e.jsx("input",{className:"input",type:"file",accept:"image/*",onChange:a=>{var d;const l=((d=a.target.files)==null?void 0:d[0])||null;i(l),p(null)}}),e.jsx("div",{style:{height:12}}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:12},children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Quality (",Math.round(n*100),"%)"]}),e.jsx("input",{className:"input",type:"range",min:.2,max:.95,step:.05,value:n,onChange:a=>t(Number(a.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Max width (px)"}),e.jsx("input",{className:"input",type:"number",value:m,onChange:a=>r(Number(a.target.value||0))})]})]}),e.jsx("div",{style:{height:10}}),e.jsxs("label",{className:"row",style:{justifyContent:"space-between"},children:[e.jsx("span",{className:"p",style:{margin:0},children:"Keep original format"}),e.jsx("input",{type:"checkbox",checked:h,onChange:()=>v(a=>!a)})]}),e.jsx("div",{style:{height:14}}),e.jsxs("div",{className:"row",children:[e.jsx(g,{onClick:N,disabled:!s||u,children:u?"Compressingâ€¦":"Compress"}),e.jsx(g,{variant:"secondary",disabled:!o,onClick:()=>{if(!o)return;const a=((s==null?void 0:s.name)||"image").replace(/\.[^.]+$/,""),l=h&&(s==null?void 0:s.type)==="image/png"?"png":"jpg";R(o,`${a}_compressed.${l}`)},children:"Download"})]}),e.jsx("div",{style:{height:12}}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:12},children:[e.jsx("div",{className:"card",style:{boxShadow:"none"},children:e.jsxs("div",{className:"section",style:{padding:12},children:[e.jsx("div",{className:"label",children:"Original"}),e.jsx("div",{style:{fontWeight:800},children:j(y)})]})}),e.jsx("div",{className:"card",style:{boxShadow:"none"},children:e.jsxs("div",{className:"section",style:{padding:12},children:[e.jsx("div",{className:"label",children:"Compressed"}),e.jsx("div",{style:{fontWeight:800},children:j(b)})]})})]})]})}),e.jsx("div",{className:"card sticky",children:e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"h2",style:{margin:0},children:"Preview"}),e.jsx("div",{style:{height:10}}),s?e.jsx("img",{src:URL.createObjectURL(s),alt:"Uploaded",style:{width:"100%",borderRadius:12,border:"1px solid rgba(255,255,255,0.08)"},onLoad:a=>URL.revokeObjectURL(a.currentTarget.src)}):e.jsx("div",{className:"muted",children:"Upload an image to preview."})]})})]})]})}export{M as default};
