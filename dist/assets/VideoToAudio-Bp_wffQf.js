import{r as w,j as t,B as f,_ as j}from"./index-BadHY94B.js";function g(a,s){const d=URL.createObjectURL(a),i=document.createElement("a");i.href=d,i.download=s,i.click(),URL.revokeObjectURL(d)}function b(a){const s=a.numberOfChannels,d=a.length*s*2+44,i=new ArrayBuffer(d),n=new DataView(i),r=(o,l)=>{for(let c=0;c<l.length;c++)n.setUint8(o+c,l.charCodeAt(c))};let e=0;r(e,"RIFF"),e+=4,n.setUint32(e,36+a.length*s*2,!0),e+=4,r(e,"WAVE"),e+=4,r(e,"fmt "),e+=4,n.setUint32(e,16,!0),e+=4,n.setUint16(e,1,!0),e+=2,n.setUint16(e,s,!0),e+=2,n.setUint32(e,a.sampleRate,!0),e+=4,n.setUint32(e,a.sampleRate*s*2,!0),e+=4,n.setUint16(e,s*2,!0),e+=2,n.setUint16(e,16,!0),e+=2,r(e,"data"),e+=4,n.setUint32(e,a.length*s*2,!0),e+=4;const h=[];for(let o=0;o<s;o++)h.push(a.getChannelData(o));let u=0;for(;u<a.length;){for(let o=0;o<s;o++){let l=h[o][u];l=Math.max(-1,Math.min(1,l)),n.setInt16(e,l<0?l*32768:l*32767,!0),e+=2}u+=1}return new Blob([i],{type:"audio/wav"})}async function F(a){const s=new(window.AudioContext||window.webkitAudioContext),d=await a.arrayBuffer(),i=await s.decodeAudioData(d),n=b(i);return s.close(),n}function _(){const[a,s]=w.useState(null),[d,i]=w.useState(!1),[n,r]=w.useState(null),[e,h]=w.useState(!1),u=w.useMemo(()=>a!=null&&a.name?a.name.replace(/\.[^.]+$/,""):"audio",[a]),o=async()=>{if(a){i(!0);try{const c=await F(a);r(c)}finally{i(!1)}}},l=async()=>{if(a){h(!0);try{const{FFmpeg:c}=await j(async()=>{const{FFmpeg:y}=await import("./index-BWXEABTF.js");return{FFmpeg:y}},[]),{fetchFile:p}=await j(async()=>{const{fetchFile:y}=await import("./index-DRPQNq22.js");return{fetchFile:y}},[]),m=new c;await m.load();const x=`input_${Date.now()}.mp4`,v=`output_${Date.now()}.mp3`;await m.writeFile(x,await p(a)),await m.exec(["-i",x,"-vn","-acodec","libmp3lame","-q:a","4",v]);const N=await m.readFile(v),B=new Blob([N.buffer],{type:"audio/mpeg"});g(B,`${u}.mp3`),await m.deleteFile(x),await m.deleteFile(v)}finally{h(!1)}}};return t.jsxs("div",{className:"container",children:[t.jsxs("div",{className:"row",style:{justifyContent:"space-between",marginBottom:12},children:[t.jsxs("div",{children:[t.jsx("div",{className:"h1",style:{fontSize:28},children:"Video → Audio"}),t.jsx("p",{className:"p",children:"Extract audio locally. WAV is instant; MP3 is optional (downloads encoder on demand)."})]}),t.jsx("span",{className:"badge",children:"Frontend only"})]}),t.jsxs("div",{className:"split",children:[t.jsx("div",{className:"card",children:t.jsxs("div",{className:"section",children:[t.jsx("label",{className:"label",children:"Upload video"}),t.jsx("input",{className:"input",type:"file",accept:"video/*",onChange:c=>{var p;s(((p=c.target.files)==null?void 0:p[0])||null),r(null)}}),t.jsx("div",{style:{height:12}}),t.jsxs("div",{className:"row",children:[t.jsx(f,{onClick:o,disabled:!a||d,children:d?"Extracting…":"Extract WAV"}),t.jsx(f,{variant:"secondary",disabled:!n,onClick:()=>{n&&g(n,`${u}.wav`)},children:"Download WAV"})]}),t.jsx("div",{style:{height:12}}),t.jsx("div",{className:"card",style:{boxShadow:"none"},children:t.jsxs("div",{className:"section",style:{padding:12},children:[t.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"MP3 (advanced)"}),t.jsx("div",{className:"muted",style:{marginBottom:10},children:"MP3 conversion uses ffmpeg.wasm and may take time on low-end devices. It is loaded only when you click."}),t.jsx(f,{onClick:l,disabled:!a||e,children:e?"Loading encoder…":"Export MP3"})]})})]})}),t.jsx("div",{className:"card sticky",children:t.jsxs("div",{className:"section",children:[t.jsx("div",{className:"h2",style:{margin:0},children:"Notes"}),t.jsx("div",{style:{height:10}}),t.jsx("div",{className:"muted",children:"For interviews: this is a frontend-only pipeline. No files are uploaded; encoding happens in the browser."})]})})]})]})}export{_ as default};
